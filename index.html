<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>B7 STORE ğŸ‘‘ â€” Ù…ØªØ¬Ø± Ø§Ø­ØªØ±Ø§ÙÙŠ</title>
  <style>
    /* ====== Ù‚Ø§Ø¹Ø¯Ø© ÙˆØªØµÙ…ÙŠÙ… Ø¹Ø§Ù… ====== */
    :root{
      --bg1:#060607;
      --bg2:#0f1724;
      --card:#0d1114;
      --accent1:#00d2ff;
      --accent2:#0066ff;
      --muted:#9aa4b2;
      --glass: rgba(255,255,255,0.03);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: "Tajawal", "Poppins", system-ui, sans-serif;
      background: radial-gradient(1200px 600px at 10% 10%, rgba(0,110,255,0.06), transparent),
                  linear-gradient(180deg,var(--bg1),var(--bg2));
      color:#e6eef8;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      direction:rtl;
    }

    header{
      padding:28px 20px;
      display:flex;
      gap:16px;
      align-items:center;
      justify-content:space-between;
      position:sticky;
      top:0;
      backdrop-filter: blur(6px);
      background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
      border-bottom:1px solid rgba(255,255,255,0.03);
      z-index:40;
    }

    .brand {
      display:flex;
      gap:12px;
      align-items:center;
    }
    .logo {
      width:54px;height:54px;border-radius:12px;
      display:grid;place-items:center;
      background:linear-gradient(135deg,var(--accent1),var(--accent2));
      box-shadow: 0 6px 20px rgba(2,132,255,0.12);
      font-weight:800;
    }
    .brand h1{font-size:18px;margin:0}
    .brand p{margin:0;font-size:12px;color:var(--muted)}

    /* Ø¨Ø­Ø« ÙˆÙÙ„ØªØ± */
    .controls{
      display:flex;
      gap:12px;
      align-items:center;
    }
    .search {
      display:flex;
      gap:8px;
      align-items:center;
      background:var(--glass);
      padding:8px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.03);
      width:320px;
    }
    .search input{
      background:transparent;border:0;outline:none;color:inherit;width:100%;
      font-size:14px;
    }
    .select{
      background:transparent;border:1px solid rgba(255,255,255,0.04);padding:8px;border-radius:10px;color:inherit;
    }

    /* Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */
    main{padding:22px}
    .grid{
      display:grid;
      grid-template-columns: repeat(auto-fit,minmax(260px,1fr));
      gap:18px;
    }
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02));
      border-radius:14px;padding:14px;border:1px solid rgba(255,255,255,0.03);
      box-shadow: 0 6px 20px rgba(2,132,255,0.04);
      transition: transform .25s ease, box-shadow .25s ease;
    }
    .card:hover{ transform: translateY(-8px); box-shadow: 0 18px 50px rgba(2,132,255,0.08); }
    .thumb{ width:100%; height:160px; border-radius:10px; object-fit:cover; background:#071126; display:block }
    h3{ margin:10px 0 6px 0; font-size:16px }
    p.desc{ margin:0 0 12px 0; color:var(--muted); font-size:13px }

    .meta {display:flex;gap:8px;align-items:center;justify-content:space-between}
    .price { font-weight:700; font-size:15px; color:var(--accent1) }
    .btn {
      display:inline-flex; gap:8px; align-items:center;
      padding:8px 12px;border-radius:10px;border:0;cursor:pointer;
      background:linear-gradient(90deg,var(--accent1),var(--accent2));
      color:#001; font-weight:700; transition:transform .15s;
    }
    .btn:active{ transform:scale(.98) }

    /* Ø³Ù„Ø© ÙˆÙ…ÙˆØ¯Ø§Ù„ */
    .cart-btn{ background:transparent;border:1px solid rgba(255,255,255,0.04); padding:8px 10px;border-radius:10px;color:var(--muted) }
    .cart-count{ background:var(--accent1); color:#001; padding:2px 7px;border-radius:999px;font-weight:700;margin-inline-start:6px;font-size:12px }

    .floating-cart{
      position:fixed; left:20px; bottom:24px; z-index:80;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.04));
      border-radius:14px; padding:12px; border:1px solid rgba(255,255,255,0.04);
      box-shadow:0 10px 40px rgba(2,132,255,0.08);
    }

    /* Ù…ÙˆØ¯Ø§Ù„ */
    .modal-backdrop{
      position:fixed;inset:0;background:rgba(0,0,0,0.6);display:none;place-items:center;z-index:100;
      padding:20px;
    }
    .modal{
      width:100%;max-width:720px;background:linear-gradient(180deg,#081016,#071021);
      border-radius:12px;padding:18px;border:1px solid rgba(255,255,255,0.04);
    }
    .modal h2{margin-top:0}
    .cart-list{ max-height:320px; overflow:auto; margin:12px 0; border-radius:8px }
    .cart-item{ display:flex; gap:12px; align-items:center; padding:10px; border-bottom:1px dashed rgba(255,255,255,0.02) }
    .cart-item img{ width:64px; height:48px; object-fit:cover; border-radius:8px }

    .actions{ display:flex; gap:8px; justify-content:flex-end; margin-top:12px }

    /* Ø±Ø³Ø§Ø¦Ù„ ØµØºÙŠØ±Ø© */
    .note{ font-size:13px;color:var(--muted); margin-top:6px }

    /* ØªØ¬Ø§ÙˆØ¨ */
    @media(max-width:520px){
      .search{width:170px}
      header{flex-direction:column;align-items:stretch;gap:12px}
      .controls{justify-content:space-between}
    }
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div class="logo">B7</div>
      <div>
        <h1>B7 STORE ğŸ‘‘</h1>
        <p>Ù…ØªØ¬Ø± Ø®Ø¯Ù…Ø§Øª Roblox ÙˆØ®Ø±Ø§Ø¦Ø· Ø§Ø­ØªØ±Ø§ÙÙŠ</p>
      </div>
    </div>

    <div class="controls">
      <div class="search" role="search" aria-label="Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬Ø§Øª">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" style="opacity:.8"><path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
        <input id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ø³Ù…ØŒ Ù‚Ø³Ù…ØŒ Ø®Ø±ÙŠØ·Ø©..." />
      </div>

      <select id="categorySelect" class="select" aria-label="ÙÙ„ØªØ± Ø­Ø³Ø¨ Ø§Ù„Ù‚Ø³Ù…">
        <option value="all">ÙƒÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</option>
        <option value="farm">Ù…Ø§Ø¨ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©</option>
        <option value="theft">Ù…Ø§Ø¨ Ø§Ù„Ø³Ø±Ù‚Ø©</option>
        <option value="services">Ø®Ø¯Ù…Ø§Øª/Ø³ÙƒØ±Ø¨Øª</option>
      </select>

      <button class="cart-btn" id="openCartBtn" title="Ø¹Ø±Ø¶ Ø§Ù„Ø³Ù„Ø©">
        Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª <span id="cartCount" class="cart-count" style="display:none">0</span>
      </button>
    </div>
  </header>

  <main>
    <section style="margin-bottom:16px">
      <h2 style="margin:0 0 8px 0">Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</h2>
      <div style="display:flex;gap:10px;flex-wrap:wrap">
        <button class="btn" onclick="filterBy('all')">Ø§Ù„ÙƒÙ„</button>
        <button class="btn" onclick="filterBy('farm')">Ù…Ø§Ø¨ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©</button>
        <button class="btn" onclick="filterBy('theft')">Ù…Ø§Ø¨ Ø§Ù„Ø³Ø±Ù‚Ø©</button>
        <button class="btn" onclick="filterBy('services')">Ø®Ø¯Ù…Ø§Øª</button>
      </div>
      <p class="note">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ØªØ¬ Ù„ÙØªØ­ ØªÙØ§ØµÙŠÙ„Ù‡ Ø£Ùˆ Ø£Ø¶ÙÙ‡ Ù…Ø¨Ø§Ø´Ø±Ø©Ù‹ Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©.</p>
    </section>

    <section class="grid" id="productsGrid" aria-live="polite">
      <!-- Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ØªÙÙ…Ù„Ø£ Ø¨Ø±Ù…Ø¬ÙŠØ§Ù‹ -->
    </section>
  </main>

  <!-- Ø³Ù„Ø© Ø¹Ø§Ø¦Ù…Ø© -->
  <div class="floating-cart" role="region" aria-label="Ø³Ù„Ø© Ø¹Ø§Ø¦Ù…Ø©">
    <div style="display:flex;gap:10px;align-items:center">
      <strong>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</strong>
      <div id="totalPrice" style="font-weight:800;color:var(--accent1)">0.00 MAD</div>
      <button id="checkoutBtn" class="btn" style="margin-inline-start:8px">ğŸ§¾ Ø§Ù„Ø¯ÙØ¹</button>
    </div>
    <div style="margin-top:6px;font-size:13px;color:var(--muted)">Ø·Ø±ÙŠÙ‚Ø© Ø¯ÙØ¹ Ø¨Ø§ÙŠ Ø¨Ø§Ù„ Ù…ØªØ§Ø­Ø© â€” ØºÙŠÙ‘Ø± Ø­Ø³Ø§Ø¨Ùƒ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯.</div>
  </div>

  <!-- Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ø³Ù„Ø© -->
  <div id="modal" class="modal-backdrop" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal" role="document">
      <h2>Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</h2>
      <div class="cart-list" id="cartList"></div>

      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <div>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: <strong id="modalTotal">0.00 MAD</strong></div>
          <div class="note">Ø§Ø¶ØºØ· Ø¯ÙØ¹ Ù„ÙØªØ­ ØµÙØ­Ø© PayPal. ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø³Ø§Ø¨ PayPal.me Ù…Ø¶Ø¨ÙˆØ· (PAYPAL_USERNAME).</div>
        </div>
        <div class="actions">
          <button class="btn" id="modalCheckoutBtn">Ø§Ø¯ÙØ¹ Ø¹Ø¨Ø± PayPal</button>
          <button class="cart-btn" id="closeModalBtn">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
      </div>
    </div>
  </div>

  <footer style="padding:18px;text-align:center;color:var(--muted);border-top:1px solid rgba(255,255,255,0.02);margin-top:30px">
    Â© 2025 B7 STORE ğŸ‘‘ â€” Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©
  </footer>

  <script>
    /**********************************************
     * IMPORTANT:
     * Ø¶Ø¹ Ù‡Ù†Ø§ Ø§Ø³Ù… Ø­Ø³Ø§Ø¨ PayPal.me Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ø¨Ø¯ÙˆÙ† "/" Ù†Ù‡Ø§Ø¦ÙŠØŒ
     * Ù…Ø«Ø§Ù„: const PAYPAL_USERNAME = "myPayPalName"
     **********************************************/
    const PAYPAL_USERNAME = "USERNAME_HERE"; // <-- ØºÙŠÙ‘Ø±Ù‡ Ù‚Ø¨Ù„ Ø§Ù„Ù†Ø´Ø±

    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª â€” Ø¹Ø¯Ù„ Ø£Ùˆ Ø²Ø¯ ÙƒÙ…Ø§ ØªØ±ÙŠØ¯
    const products = [
      // Ù…Ø§Ø¨ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©
      { id: "farm-1", title: "ÙƒØ±ÙŠÙÙŠÙ†", desc: "Ø­ÙŠÙˆØ§Ù† Ù†Ø§Ø¯Ø± Ù„Ù„Ù…Ø²Ø±Ø¹Ø© â€” ØªØ£Ø«ÙŠØ±Ø§Øª Ø®Ø§ØµØ©.", price: 15.00, currency:"MAD", category:"farm", map:"Ù…Ø§Ø¨ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©", img:"https://i.imgur.com/3Q7pXbW.png" },
      { id: "farm-2", title: "Ø§Ù„Ø®ÙŠÙ†", desc: "Ø­ÙŠÙˆØ§Ù† Ù…Ø²Ø±Ø¹Ø© Ø³Ø±ÙŠØ¹ ÙˆÙŠØ¹Ø·ÙŠ Ù…ÙˆØ§Ø±Ø¯.", price: 12.00, currency:"MAD", category:"farm", map:"Ù…Ø§Ø¨ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©", img:"https://i.imgur.com/7GQ7Y2m.png" },

      // Ù…Ø§Ø¨ Ø§Ù„Ø³Ø±Ù‚Ø©
      { id: "theft-1", title: "karkirkur", desc: "ÙˆØ­Ø´ Ù…Ù† Ù…Ø§Ø¨ Ø§Ù„Ø³Ø±Ù‚Ø© â€” Ø³Ù„ÙˆÙƒ Ù‡Ø¬ÙˆÙ…ÙŠ.", price: 30.00, currency:"MAD", category:"theft", map:"Ù…Ø§Ø¨ Ø§Ù„Ø³Ø±Ù‚Ø©", img:"https://i.imgur.com/Q9k1ZgE.png" },
      { id: "theft-2", title: "job job sahur", desc: "Ø­ÙŠÙˆØ§Ù† Ø³Ø±ÙŠ ÙÙŠ Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø³Ø±Ù‚Ø©.", price: 28.00, currency:"MAD", category:"theft", map:"Ù…Ø§Ø¨ Ø§Ù„Ø³Ø±Ù‚Ø©", img:"https://i.imgur.com/8eKXWqR.png" },
      { id: "theft-3", title: "saminini spayderini", desc: "Ø¹Ù†ØµØ± Ù†Ø§Ø¯Ø±ØŒ ÙŠØ´Ø¨Ù‡ Ø§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª.", price: 35.00, currency:"MAD", category:"theft", map:"Ù…Ø§Ø¨ Ø§Ù„Ø³Ø±Ù‚Ø©", img:"https://i.imgur.com/0Z0p1yQ.png" },
      { id: "theft-4", title: "Ø³Ø³Ø©ÙŠ", desc: "Ø­ÙŠÙˆØ§Ù† Ø®Ø§Øµ Ø¯Ø§Ø®Ù„ Ù…Ø§Ø¨ Ø§Ù„Ø³Ø±Ù‚Ø©.", price: 22.00, currency:"MAD", category:"theft", map:"Ù…Ø§Ø¨ Ø§Ù„Ø³Ø±Ù‚Ø©", img:"https://i.imgur.com/2zCq9bE.png" },

      // Ø®Ø¯Ù…Ø§Øª / Ø³ÙƒØ±Ø¨Øª
      { id: "svc-1", title: "ØªØ·ÙˆÙŠØ± Ø³ÙƒØ±Ø¨Øª Ù…Ø®ØµØµ", desc: "Ø³ÙƒØ±Ø¨Øª Ù…Ø§Ø¨ ÙƒØ§Ù…Ù„ Ù…Ø¹ Ù†Ø¸Ø§Ù… Ù†Ù‚Ø§Ø· ÙˆØ³ÙˆÙ‚.", price: 120.00, currency:"MAD", category:"services", map:"Ø®Ø¯Ù…Ø§Øª", img:"https://i.imgur.com/4M7IWwP.png" },
      { id: "svc-2", title: "ØªØµÙ…ÙŠÙ… Ø³ÙƒÙ† ÙˆÙˆØ§Ø¬Ù‡Ø© Ù…ØªØ¬Ø±", desc: "ÙˆØ§Ø¬Ù‡Ø© Ù…ØªÙƒØ§Ù…Ù„Ø© Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ Ù…Ø¹ Ø£Ù†Ù…ÙŠØ´Ù†.", price: 60.00, currency:"MAD", category:"services", map:"Ø®Ø¯Ù…Ø§Øª", img:"https://i.imgur.com/NmG2ZzK.png" },
    ];

    // Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ù„Ø©
    let cart = {};

    // Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù€ DOM
    const productsGrid = document.getElementById('productsGrid');
    const searchInput = document.getElementById('searchInput');
    const categorySelect = document.getElementById('categorySelect');
    const cartCountEl = document.getElementById('cartCount');
    const totalPriceEl = document.getElementById('totalPrice');
    const modal = document.getElementById('modal');
    const cartList = document.getElementById('cartList');
    const modalTotal = document.getElementById('modalTotal');

    // Ø±Ù†Ø¯Ø± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
    function renderProducts(filterText = '', filterCategory = 'all'){
      productsGrid.innerHTML = '';
      const q = filterText.trim().toLowerCase();

      const visible = products.filter(p => {
        const matchesCategory = (filterCategory === 'all') || (p.category === filterCategory);
        const matchesSearch = !q || (`${p.title} ${p.desc} ${p.category} ${p.map}`).toLowerCase().includes(q);
        return matchesCategory && matchesSearch;
      });

      if(visible.length === 0){
        productsGrid.innerHTML = `<div style="grid-column:1/-1;padding:40px;border-radius:12px;background:rgba(255,255,255,0.01);text-align:center;color:var(--muted)">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù„Ù„Ø¨Ø­Ø«</div>`;
        return;
      }

      visible.forEach(p => {
        const card = document.createElement('article');
        card.className = 'card';
        card.innerHTML = `
          <img class="thumb" src="${p.img}" alt="${p.title}" loading="lazy" />
          <h3>${p.title}</h3>
          <p class="desc">${p.desc} â€” <strong>${p.map}</strong></p>
          <div class="meta">
            <div class="price">${p.price.toFixed(2)} ${p.currency}</div>
            <div style="display:flex;gap:8px">
              <button class="btn" onclick="addToCart('${p.id}')">Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø©</button>
              <button class="cart-btn" onclick="openDetails('${p.id}')">Ø¹Ø±Ø¶</button>
            </div>
          </div>
        `;
        productsGrid.appendChild(card);
      });
    }

    // ÙØªØ­ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ (Ù†Ù…ÙˆØ°Ø¬ Ø¨Ø³ÙŠØ·)
    function openDetails(id){
      const p = products.find(x => x.id === id);
      if(!p) return alert('Ø®Ø·Ø£: Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
      // Ø¹Ø±Ø¶ Ù…ÙˆØ¯Ø§Ù„ Ù…Ø¨Ø³Ø· Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… alert (ÙŠÙ…ÙƒÙ† ØªØ·ÙˆÙŠØ±Ù‡ Ù„Ø§Ø­Ù‚Ø§Ù‹)
      const more = `${p.title}\n\n${p.desc}\nØ§Ù„Ø³Ø¹Ø±: ${p.price.toFixed(2)} ${p.currency}\nØ§Ù„Ø®Ø±ÙŠØ·Ø©: ${p.map}\n\nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¶Ø§ÙØ© Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ Ù„Ù„Ø³Ù„Ø©ØŸ`;
      if(confirm(more)){
        addToCart(id);
      }
    }

    // Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©
    function addToCart(id){
      const p = products.find(x => x.id === id);
      if(!p) return;
      cart[id] = cart[id] || { ...p, qty: 0 };
      cart[id].qty += 1;
      updateCartUI();
      // Ù„Ù…Ø³Ø© Ø¨ØµÙˆØª/Ø§Ù‡ØªØ²Ø§Ø² Ù‚ØµÙŠØ±Ø© Ø¥Ù† Ø£Ø±Ø¯Øª (Ù…ØªØµÙØ­ ÙŠØ¯Ø¹Ù…)
      try{ if(navigator.vibrate) navigator.vibrate(60); } catch(e){}
    }

    // Ø¥Ø²Ø§Ù„Ø©/ØªØ¹Ø¯ÙŠÙ„
    function removeFromCart(id){
      if(!cart[id]) return;
      delete cart[id];
      updateCartUI();
    }
    function changeQty(id, delta){
      if(!cart[id]) return;
      cart[id].qty += delta;
      if(cart[id].qty <= 0) delete cart[id];
      updateCartUI();
    }

    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ ÙˆØ¹Ø±Ø¶
    function computeTotal(){
      let total = 0;
      Object.values(cart).forEach(item => total += item.price * item.qty);
      return total;
    }

    function updateCartUI(){
      const keys = Object.keys(cart);
      if(keys.length === 0){
        cartCountEl.style.display = 'none';
        cartCountEl.textContent = '0';
      } else {
        cartCountEl.style.display = 'inline-block';
        const qty = keys.reduce((s,k)=> s + cart[k].qty,0);
        cartCountEl.textContent = qty;
      }
      const total = computeTotal();
      totalPriceEl.textContent = total.toFixed(2) + " MAD";
      modalTotal.textContent = total.toFixed(2) + " MAD";
      // Ø±Ù†Ø¯Ø± Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
      renderCartList();
    }

    function renderCartList(){
      cartList.innerHTML = '';
      const keys = Object.keys(cart);
      if(keys.length === 0){
        cartList.innerHTML = `<div style="padding:20px;color:var(--muted)">Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</div>`;
        return;
      }
      keys.forEach(k => {
        const it = cart[k];
        const div = document.createElement('div');
        div.className = 'cart-item';
        div.innerHTML = `
          <img src="${it.img}" alt="${it.title}" />
          <div style="flex:1;text-align:right">
            <div style="font-weight:700">${it.title}</div>
            <div style="color:var(--muted);font-size:13px">${it.price.toFixed(2)} ${it.currency} Ã— ${it.qty}</div>
          </div>
          <div style="display:flex;flex-direction:column;gap:6px;align-items:flex-start">
            <button class="cart-btn" onclick="changeQty('${k}',1)">+</button>
            <button class="cart-btn" onclick="changeQty('${k}',-1)">âˆ’</button>
            <button class="cart-btn" onclick="removeFromCart('${k}')">Ø­Ø°Ù</button>
          </div>
        `;
        cartList.appendChild(div);
      });
    }

    // ÙÙ„ØªØ±Ø© Ù…Ù† Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
    function filterBy(category){
      categorySelect.value = category === 'all' ? 'all' : category;
      renderProducts(searchInput.value, categorySelect.value);
    }

    // Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ÙÙ„ØªØ±
    searchInput.addEventListener('input', () => {
      renderProducts(searchInput.value, categorySelect.value);
    });
    categorySelect.addEventListener('change', () => {
      renderProducts(searchInput.value, categorySelect.value);
    });

    // ÙØªØ­/Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
    document.getElementById('openCartBtn').addEventListener('click', () => {
      modal.style.display = 'grid';
      modal.setAttribute('aria-hidden','false');
    });
    document.getElementById('closeModalBtn').addEventListener('click', closeModal);
    function closeModal(){
      modal.style.display = 'none';
      modal.setAttribute('aria-hidden','true');
    }
    // Ø§ØºÙ„Ø§Ù‚ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø®Ø§Ø±Ø¬ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
    modal.addEventListener('click', (e) => {
      if(e.target === modal) closeModal();
    });

    // Ø§Ù„Ø¯ÙØ¹ â€” ÙŠÙØªØ­ Ù†Ø§ÙØ°Ø© PayPal.me Ø£Ùˆ ÙŠØ¹Ù„Ù‘Ù‚ Ø¥Ù† Ù„Ù… ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø­Ø³Ø§Ø¨
    function checkout(){
      const total = computeTotal();
      if(total <= 0){
        alert("Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©ØŒ Ø£Ø¶Ù Ù…Ù†ØªØ¬Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ø¯ÙØ¹.");
        return;
      }
      if(!PAYPAL_USERNAME || PAYPAL_USERNAME === "USERNAME_HERE"){
        // ØªØ­Ø°ÙŠØ± ÙˆØ§Ø¶Ø­ ÙˆÙ„ÙŠØ³ Ø±ÙØ¶Ø§Ù‹
        const ok = confirm("Ù„Ù… ØªØ¶Ù Ø§Ø³Ù… Ø­Ø³Ø§Ø¨ PayPal.me ÙÙŠ Ø§Ù„ÙƒÙˆØ¯. Ø§Ø¶ØºØ· OK Ù„Ù†Ø³Ø® Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¯ÙØ¹ (ÙŠÙ…ÙƒÙ†Ùƒ ÙˆØ¶Ø¹ Ø§Ø³Ù… Ø­Ø³Ø§Ø¨Ùƒ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯). Ø§Ø¶ØºØ· Cancel Ù„Ø¥Ù„ØºØ§Ø¡.");
        if(!ok) return;
        // Ø§Ù†Ø³Ø® Ù†Øµ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ù„Ù†Ø³Ø® ÙŠØ¯ÙˆÙŠ
        copyToClipboard(`ÙØ§ØªÙˆØ±Ø© Ù…Ù† B7 STORE: Ø§Ù„Ù…Ø¨Ù„Øº ${total.toFixed(2)} MAD`);
        alert("ØªÙ… Ù†Ø³Ø® Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ø¨Ù„Øº Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©. Ø¨Ø¹Ø¯ Ø°Ù„Ùƒ Ø§ÙØªØ­ PayPal.me/Ø§Ø³Ù…Ùƒ ÙˆØ§Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº ÙŠØ¯ÙˆÙŠØ§Ù‹.");
        return;
      }

      // ØªÙƒÙˆÙŠÙ† Ø±Ø§Ø¨Ø· PayPal.me â€” Ù…Ù„Ø§Ø­Ø¸Ø©: Ø¨Ø¹Ø¶ Ø­Ø³Ø§Ø¨Ø§Øª PayPal.me ØªØ¯Ø¹Ù… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù„Øº Ø¹Ø¨Ø± /{amount}{currency}
      // Ù…Ø«Ø§Ù„: https://paypal.me/USERNAME/25MAD
      // Ù†Ø³ØªØ®Ø¯Ù… Ø°Ù„Ùƒ Ù„ÙƒÙ† Ù†Ø¹Ø±Ø¶ Ø£ÙŠØ¶Ø§Ù‹ ØªÙ†Ø¨ÙŠÙ‡ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ù„ØªØ£ÙƒØ¯.
      const amountStr = encodeURIComponent(total.toFixed(2) + "MAD");
      const url = `https://paypal.me/${encodeURIComponent(PAYPAL_USERNAME)}/${amountStr}`;

      // Ù†ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø· ÙÙŠ Ù†Ø§ÙØ°Ø© Ø¬Ø¯ÙŠØ¯Ø©
      window.open(url, '_blank');

      // Ø§Ù‚ØªØ±Ø§Ø­ ØªØ³Ø¬ÙŠÙ„ Ø·Ù„Ø¨ Ø£Ùˆ Ø¥Ø±Ø³Ø§Ù„ ØªÙØ§ØµÙŠÙ„ (ÙŠÙ…ÙƒÙ† Ø±Ø¨Ø· Ø¨Ø®Ø§Ø¯Ù… Ù„Ø§Ø­Ù‚Ø§Ù‹)
    }

    // Ø²Ø± Ø§Ù„Ø¯ÙØ¹ ÙÙŠ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ ÙˆØ§Ù„Ø²Ø± Ø§Ù„Ø¹Ø§Ø¦Ù…
    document.getElementById('checkoutBtn').addEventListener('click', () => {
      // Ø§ÙØªØ­ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ Ø£ÙˆÙ„Ø§Ù‹
      modal.style.display = 'grid';
      modal.setAttribute('aria-hidden','false');
    });
    document.getElementById('modalCheckoutBtn').addEventListener('click', checkout);

    // Ù…Ø³Ø§Ø¹Ø¯Ø© - Ù†Ø³Ø® Ù„Ù„Ø­Ø§ÙØ¸Ø©
    function copyToClipboard(text){
      if(navigator.clipboard && navigator.clipboard.writeText){
        navigator.clipboard.writeText(text).catch(()=>{});
      } else {
        const ta = document.createElement('textarea');
        ta.value = text; document.body.appendChild(ta); ta.select();
        try{ document.execCommand('copy'); }catch(e){}
        ta.remove();
      }
    }

    // Ø±Ù†Ø¯Ø± Ø£ÙˆÙ„ÙŠ
    renderProducts();

    // Ø§Ø®ØªÙŠØ§Ø±ÙŠ: ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø³Ù„Ø© ÙÙŠ localStorage Ø­ØªÙ‰ Ù„Ø§ ØªØ¶ÙŠØ¹
    function saveCart(){
      localStorage.setItem('b7_cart', JSON.stringify(cart));
    }
    function loadCart(){
      try{
        const s = localStorage.getItem('b7_cart');
        if(s) cart = JSON.parse(s);
      }catch(e){ cart = {}; }
      updateCartUI();
    }
    window.addEventListener('beforeunload', saveCart);
    loadCart();

    // ÙØ­Øµ Ø£Ø®Ø·Ø§Ø¡ Ø¨Ø³ÙŠØ·Ø© (Ù„Ø¶Ù…Ø§Ù† Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø£Ø®Ø·Ø§Ø¡ Ø´Ø§Ø¦Ø¹Ø©)
    window.addEventListener('error', (e) => {
      console.error('Runtime error:', e.error || e.message);
      // Ù„Ø§ Ù†ÙØ¸Ù‡Ø± Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø´ÙŠØ¦Ø§Ù‹ Ù…Ø²Ø¹Ø¬Ø§Ù‹ Ù„ÙƒÙ† ÙŠÙ…ÙƒÙ† Ø¥Ø±Ø³Ø§Ù„ Ù‡Ø°Ø§ Ù„Ù„Ø®Ø§Ø¯Ù… Ù„Ø§Ø­Ù‚Ø§Ù‹
    });
  </script>
</body>
        </htm<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>B7 STORE ğŸ‘‘ â€” Ù…ØªØ¬Ø± Ø§Ø­ØªØ±Ø§ÙÙŠ</title>
  <style>
    /* ====== Ù‚Ø§Ø¹Ø¯Ø© ÙˆØªØµÙ…ÙŠÙ… Ø¹Ø§Ù… ====== */
    :root{
      --bg1:#060607;
      --bg2:#0f1724;
      --card:#0d1114;
      --accent1:#00d2ff;
      --accent2:#0066ff;
      --muted:#9aa4b2;
      --glass: rgba(255,255,255,0.03);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: "Tajawal", "Poppins", system-ui, sans-serif;
      background: radial-gradient(1200px 600px at 10% 10%, rgba(0,110,255,0.06), transparent),
                  linear-gradient(180deg,var(--bg1),var(--bg2));
      color:#e6eef8;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      direction:rtl;
    }

    header{
      padding:28px 20px;
      display:flex;
      gap:16px;
      align-items:center;
      justify-content:space-between;
      position:sticky;
      top:0;
      backdrop-filter: blur(6px);
      background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
      border-bottom:1px solid rgba(255,255,255,0.03);
      z-index:40;
    }

    .brand {
      display:flex;
      gap:12px;
      align-items:center;
    }
    .logo {
      width:54px;height:54px;border-radius:12px;
      display:grid;place-items:center;
      background:linear-gradient(135deg,var(--accent1),var(--accent2));
      box-shadow: 0 6px 20px rgba(2,132,255,0.12);
      font-weight:800;
    }
    .brand h1{font-size:18px;margin:0}
    .brand p{margin:0;font-size:12px;color:var(--muted)}

    /* Ø¨Ø­Ø« ÙˆÙÙ„ØªØ± */
    .controls{
      display:flex;
      gap:12px;
      align-items:center;
    }
    .search {
      display:flex;
      gap:8px;
      align-items:center;
      background:var(--glass);
      padding:8px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.03);
      width:320px;
    }
    .search input{
      background:transparent;border:0;outline:none;color:inherit;width:100%;
      font-size:14px;
    }
    .select{
      background:transparent;border:1px solid rgba(255,255,255,0.04);padding:8px;border-radius:10px;color:inherit;
    }

    /* Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */
    main{padding:22px}
    .grid{
      display:grid;
      grid-template-columns: repeat(auto-fit,minmax(260px,1fr));
      gap:18px;
    }
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02));
      border-radius:14px;padding:14px;border:1px solid rgba(255,255,255,0.03);
      box-shadow: 0 6px 20px rgba(2,132,255,0.04);
      transition: transform .25s ease, box-shadow .25s ease;
    }
    .card:hover{ transform: translateY(-8px); box-shadow: 0 18px 50px rgba(2,132,255,0.08); }
    .thumb{ width:100%; height:160px; border-radius:10px; object-fit:cover; background:#071126; display:block }
    h3{ margin:10px 0 6px 0; font-size:16px }
    p.desc{ margin:0 0 12px 0; color:var(--muted); font-size:13px }

    .meta {display:flex;gap:8px;align-items:center;justify-content:space-between}
    .price { font-weight:700; font-size:15px; color:var(--accent1) }
    .btn {
      display:inline-flex; gap:8px; align-items:center;
      padding:8px 12px;border-radius:10px;border:0;cursor:pointer;
      background:linear-gradient(90deg,var(--accent1),var(--accent2));
      color:#001; font-weight:700; transition:transform .15s;
    }
    .btn:active{ transform:scale(.98) }

    /* Ø³Ù„Ø© ÙˆÙ…ÙˆØ¯Ø§Ù„ */
    .cart-btn{ background:transparent;border:1px solid rgba(255,255,255,0.04); padding:8px 10px;border-radius:10px;color:var(--muted) }
    .cart-count{ background:var(--accent1); color:#001; padding:2px 7px;border-radius:999px;font-weight:700;margin-inline-start:6px;font-size:12px }

    .floating-cart{
      position:fixed; left:20px; bottom:24px; z-index:80;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.04));
      border-radius:14px; padding:12px; border:1px solid rgba(255,255,255,0.04);
      box-shadow:0 10px 40px rgba(2,132,255,0.08);
    }

    /* Ù…ÙˆØ¯Ø§Ù„ */
    .modal-backdrop{
      position:fixed;inset:0;background:rgba(0,0,0,0.6);display:none;place-items:center;z-index:100;
      padding:20px;
    }
    .modal{
      width:100%;max-width:720px;background:linear-gradient(180deg,#081016,#071021);
      border-radius:12px;padding:18px;border:1px solid rgba(255,255,255,0.04);
    }
    .modal h2{margin-top:0}
    .cart-list{ max-height:320px; overflow:auto; margin:12px 0; border-radius:8px }
    .cart-item{ display:flex; gap:12px; align-items:center; padding:10px; border-bottom:1px dashed rgba(255,255,255,0.02) }
    .cart-item img{ width:64px; height:48px; object-fit:cover; border-radius:8px }

    .actions{ display:flex; gap:8px; justify-content:flex-end; margin-top:12px }

    /* Ø±Ø³Ø§Ø¦Ù„ ØµØºÙŠØ±Ø© */
    .note{ font-size:13px;color:var(--muted); margin-top:6px }

    /* ØªØ¬Ø§ÙˆØ¨ */
    @media(max-width:520px){
      .search{width:170px}
      header{flex-direction:column;align-items:stretch;gap:12px}
      .controls{justify-content:space-between}
    }
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div class="logo">B7</div>
      <div>
        <h1>B7 STORE ğŸ‘‘</h1>
        <p>Ù…ØªØ¬Ø± Ø®Ø¯Ù…Ø§Øª Roblox ÙˆØ®Ø±Ø§Ø¦Ø· Ø§Ø­ØªØ±Ø§ÙÙŠ</p>
      </div>
    </div>

    <div class="controls">
      <div class="search" role="search" aria-label="Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬Ø§Øª">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" style="opacity:.8"><path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
        <input id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ø³Ù…ØŒ Ù‚Ø³Ù…ØŒ Ø®Ø±ÙŠØ·Ø©..." />
      </div>

      <select id="categorySelect" class="select" aria-label="ÙÙ„ØªØ± Ø­Ø³Ø¨ Ø§Ù„Ù‚Ø³Ù…">
        <option value="all">ÙƒÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</option>
        <option value="farm">Ù…Ø§Ø¨ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©</option>
        <option value="theft">Ù…Ø§Ø¨ Ø§Ù„Ø³Ø±Ù‚Ø©</option>
        <option value="services">Ø®Ø¯Ù…Ø§Øª/Ø³ÙƒØ±Ø¨Øª</option>
      </select>

      <button class="cart-btn" id="openCartBtn" title="Ø¹Ø±Ø¶ Ø§Ù„Ø³Ù„Ø©">
        Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª <span id="cartCount" class="cart-count" style="display:none">0</span>
      </button>
    </div>
  </header>

  <main>
    <section style="margin-bottom:16px">
      <h2 style="margin:0 0 8px 0">Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</h2>
      <div style="display:flex;gap:10px;flex-wrap:wrap">
        <button class="btn" onclick="filterBy('all')">Ø§Ù„ÙƒÙ„</button>
        <button class="btn" onclick="filterBy('farm')">Ù…Ø§Ø¨ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©</button>
        <button class="btn" onclick="filterBy('theft')">Ù…Ø§Ø¨ Ø§Ù„Ø³Ø±Ù‚Ø©</button>
        <button class="btn" onclick="filterBy('services')">Ø®Ø¯Ù…Ø§Øª</button>
      </div>
      <p class="note">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ØªØ¬ Ù„ÙØªØ­ ØªÙØ§ØµÙŠÙ„Ù‡ Ø£Ùˆ Ø£Ø¶ÙÙ‡ Ù…Ø¨Ø§Ø´Ø±Ø©Ù‹ Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©.</p>
    </section>

    <section class="grid" id="productsGrid" aria-live="polite">
      <!-- Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ØªÙÙ…Ù„Ø£ Ø¨Ø±Ù…Ø¬ÙŠØ§Ù‹ -->
    </section>
  </main>

  <!-- Ø³Ù„Ø© Ø¹Ø§Ø¦Ù…Ø© -->
  <div class="floating-cart" role="region" aria-label="Ø³Ù„Ø© Ø¹Ø§Ø¦Ù…Ø©">
    <div style="display:flex;gap:10px;align-items:center">
      <strong>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</strong>
      <div id="totalPrice" style="font-weight:800;color:var(--accent1)">0.00 MAD</div>
      <button id="checkoutBtn" class="btn" style="margin-inline-start:8px">ğŸ§¾ Ø§Ù„Ø¯ÙØ¹</button>
    </div>
    <div style="margin-top:6px;font-size:13px;color:var(--muted)">Ø·Ø±ÙŠÙ‚Ø© Ø¯ÙØ¹ Ø¨Ø§ÙŠ Ø¨Ø§Ù„ Ù…ØªØ§Ø­Ø© â€” ØºÙŠÙ‘Ø± Ø­Ø³Ø§Ø¨Ùƒ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯.</div>
  </div>

  <!-- Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ø³Ù„Ø© -->
  <div id="modal" class="modal-backdrop" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal" role="document">
      <h2>Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</h2>
      <div class="cart-list" id="cartList"></div>

      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <div>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: <strong id="modalTotal">0.00 MAD</strong></div>
          <div class="note">Ø§Ø¶ØºØ· Ø¯ÙØ¹ Ù„ÙØªØ­ ØµÙØ­Ø© PayPal. ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø³Ø§Ø¨ PayPal.me Ù…Ø¶Ø¨ÙˆØ· (PAYPAL_USERNAME).</div>
        </div>
        <div class="actions">
          <button class="btn" id="modalCheckoutBtn">Ø§Ø¯ÙØ¹ Ø¹Ø¨Ø± PayPal</button>
          <button class="cart-btn" id="closeModalBtn">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
      </div>
    </div>
  </div>

  <footer style="padding:18px;text-align:center;color:var(--muted);border-top:1px solid rgba(255,255,255,0.02);margin-top:30px">
    Â© 2025 B7 STORE ğŸ‘‘ â€” Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©
  </footer>

  <script>
    /**********************************************
     * IMPORTANT:
     * Ø¶Ø¹ Ù‡Ù†Ø§ Ø§Ø³Ù… Ø­Ø³Ø§Ø¨ PayPal.me Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ø¨Ø¯ÙˆÙ† "/" Ù†Ù‡Ø§Ø¦ÙŠØŒ
     * Ù…Ø«Ø§Ù„: const PAYPAL_USERNAME = "myPayPalName"
     **********************************************/
    const PAYPAL_USERNAME = "USERNAME_HERE"; // <-- ØºÙŠÙ‘Ø±Ù‡ Ù‚Ø¨Ù„ Ø§Ù„Ù†Ø´Ø±

    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª â€” Ø¹Ø¯Ù„ Ø£Ùˆ Ø²Ø¯ ÙƒÙ…Ø§ ØªØ±ÙŠØ¯
    const products = [
      // Ù…Ø§Ø¨ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©
      { id: "farm-1", title: "ÙƒØ±ÙŠÙÙŠÙ†", desc: "Ø­ÙŠÙˆØ§Ù† Ù†Ø§Ø¯Ø± Ù„Ù„Ù…Ø²Ø±Ø¹Ø© â€” ØªØ£Ø«ÙŠØ±Ø§Øª Ø®Ø§ØµØ©.", price: 15.00, currency:"MAD", category:"farm", map:"Ù…Ø§Ø¨ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©", img:"https://i.imgur.com/3Q7pXbW.png" },
      { id: "farm-2", title: "Ø§Ù„Ø®ÙŠÙ†", desc: "Ø­ÙŠÙˆØ§Ù† Ù…Ø²Ø±Ø¹Ø© Ø³Ø±ÙŠØ¹ ÙˆÙŠØ¹Ø·ÙŠ Ù…ÙˆØ§Ø±Ø¯.", price: 12.00, currency:"MAD", category:"farm", map:"Ù…Ø§Ø¨ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©", img:"https://i.imgur.com/7GQ7Y2m.png" },

      // Ù…Ø§Ø¨ Ø§Ù„Ø³Ø±Ù‚Ø©
      { id: "theft-1", title: "karkirkur", desc: "ÙˆØ­Ø´ Ù…Ù† Ù…Ø§Ø¨ Ø§Ù„Ø³Ø±Ù‚Ø© â€” Ø³Ù„ÙˆÙƒ Ù‡Ø¬ÙˆÙ…ÙŠ.", price: 30.00, currency:"MAD", category:"theft", map:"Ù…Ø§Ø¨ Ø§Ù„Ø³Ø±Ù‚Ø©", img:"https://i.imgur.com/Q9k1ZgE.png" },
      { id: "theft-2", title: "job job sahur", desc: "Ø­ÙŠÙˆØ§Ù† Ø³Ø±ÙŠ ÙÙŠ Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø³Ø±Ù‚Ø©.", price: 28.00, currency:"MAD", category:"theft", map:"Ù…Ø§Ø¨ Ø§Ù„Ø³Ø±Ù‚Ø©", img:"https://i.imgur.com/8eKXWqR.png" },
      { id: "theft-3", title: "saminini spayderini", desc: "Ø¹Ù†ØµØ± Ù†Ø§Ø¯Ø±ØŒ ÙŠØ´Ø¨Ù‡ Ø§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª.", price: 35.00, currency:"MAD", category:"theft", map:"Ù…Ø§Ø¨ Ø§Ù„Ø³Ø±Ù‚Ø©", img:"https://i.imgur.com/0Z0p1yQ.png" },
      { id: "theft-4", title: "Ø³Ø³Ø©ÙŠ", desc: "Ø­ÙŠÙˆØ§Ù† Ø®Ø§Øµ Ø¯Ø§Ø®Ù„ Ù…Ø§Ø¨ Ø§Ù„Ø³Ø±Ù‚Ø©.", price: 22.00, currency:"MAD", category:"theft", map:"Ù…Ø§Ø¨ Ø§Ù„Ø³Ø±Ù‚Ø©", img:"https://i.imgur.com/2zCq9bE.png" },

      // Ø®Ø¯Ù…Ø§Øª / Ø³ÙƒØ±Ø¨Øª
      { id: "svc-1", title: "ØªØ·ÙˆÙŠØ± Ø³ÙƒØ±Ø¨Øª Ù…Ø®ØµØµ", desc: "Ø³ÙƒØ±Ø¨Øª Ù…Ø§Ø¨ ÙƒØ§Ù…Ù„ Ù…Ø¹ Ù†Ø¸Ø§Ù… Ù†Ù‚Ø§Ø· ÙˆØ³ÙˆÙ‚.", price: 120.00, currency:"MAD", category:"services", map:"Ø®Ø¯Ù…Ø§Øª", img:"https://i.imgur.com/4M7IWwP.png" },
      { id: "svc-2", title: "ØªØµÙ…ÙŠÙ… Ø³ÙƒÙ† ÙˆÙˆØ§Ø¬Ù‡Ø© Ù…ØªØ¬Ø±", desc: "ÙˆØ§Ø¬Ù‡Ø© Ù…ØªÙƒØ§Ù…Ù„Ø© Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ Ù…Ø¹ Ø£Ù†Ù…ÙŠØ´Ù†.", price: 60.00, currency:"MAD", category:"services", map:"Ø®Ø¯Ù…Ø§Øª", img:"https://i.imgur.com/NmG2ZzK.png" },
    ];

    // Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ù„Ø©
    let cart = {};

    // Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù€ DOM
    const productsGrid = document.getElementById('productsGrid');
    const searchInput = document.getElementById('searchInput');
    const categorySelect = document.getElementById('categorySelect');
    const cartCountEl = document.getElementById('cartCount');
    const totalPriceEl = document.getElementById('totalPrice');
    const modal = document.getElementById('modal');
    const cartList = document.getElementById('cartList');
    const modalTotal = document.getElementById('modalTotal');

    // Ø±Ù†Ø¯Ø± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
    function renderProducts(filterText = '', filterCategory = 'all'){
      productsGrid.innerHTML = '';
      const q = filterText.trim().toLowerCase();

      const visible = products.filter(p => {
        const matchesCategory = (filterCategory === 'all') || (p.category === filterCategory);
        const matchesSearch = !q || (`${p.title} ${p.desc} ${p.category} ${p.map}`).toLowerCase().includes(q);
        return matchesCategory && matchesSearch;
      });

      if(visible.length === 0){
        productsGrid.innerHTML = `<div style="grid-column:1/-1;padding:40px;border-radius:12px;background:rgba(255,255,255,0.01);text-align:center;color:var(--muted)">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù„Ù„Ø¨Ø­Ø«</div>`;
        return;
      }

      visible.forEach(p => {
        const card = document.createElement('article');
        card.className = 'card';
        card.innerHTML = `
          <img class="thumb" src="${p.img}" alt="${p.title}" loading="lazy" />
          <h3>${p.title}</h3>
          <p class="desc">${p.desc} â€” <strong>${p.map}</strong></p>
          <div class="meta">
            <div class="price">${p.price.toFixed(2)} ${p.currency}</div>
            <div style="display:flex;gap:8px">
              <button class="btn" onclick="addToCart('${p.id}')">Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø©</button>
              <button class="cart-btn" onclick="openDetails('${p.id}')">Ø¹Ø±Ø¶</button>
            </div>
          </div>
        `;
        productsGrid.appendChild(card);
      });
    }

    // ÙØªØ­ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ (Ù†Ù…ÙˆØ°Ø¬ Ø¨Ø³ÙŠØ·)
    function openDetails(id){
      const p = products.find(x => x.id === id);
      if(!p) return alert('Ø®Ø·Ø£: Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
      // Ø¹Ø±Ø¶ Ù…ÙˆØ¯Ø§Ù„ Ù…Ø¨Ø³Ø· Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… alert (ÙŠÙ…ÙƒÙ† ØªØ·ÙˆÙŠØ±Ù‡ Ù„Ø§Ø­Ù‚Ø§Ù‹)
      const more = `${p.title}\n\n${p.desc}\nØ§Ù„Ø³Ø¹Ø±: ${p.price.toFixed(2)} ${p.currency}\nØ§Ù„Ø®Ø±ÙŠØ·Ø©: ${p.map}\n\nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¶Ø§ÙØ© Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ Ù„Ù„Ø³Ù„Ø©ØŸ`;
      if(confirm(more)){
        addToCart(id);
      }
    }

    // Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©
    function addToCart(id){
      const p = products.find(x => x.id === id);
      if(!p) return;
      cart[id] = cart[id] || { ...p, qty: 0 };
      cart[id].qty += 1;
      updateCartUI();
      // Ù„Ù…Ø³Ø© Ø¨ØµÙˆØª/Ø§Ù‡ØªØ²Ø§Ø² Ù‚ØµÙŠØ±Ø© Ø¥Ù† Ø£Ø±Ø¯Øª (Ù…ØªØµÙØ­ ÙŠØ¯Ø¹Ù…)
      try{ if(navigator.vibrate) navigator.vibrate(60); } catch(e){}
    }

    // Ø¥Ø²Ø§Ù„Ø©/ØªØ¹Ø¯ÙŠÙ„
    function removeFromCart(id){
      if(!cart[id]) return;
      delete cart[id];
      updateCartUI();
    }
    function changeQty(id, delta){
      if(!cart[id]) return;
      cart[id].qty += delta;
      if(cart[id].qty <= 0) delete cart[id];
      updateCartUI();
    }

    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ ÙˆØ¹Ø±Ø¶
    function computeTotal(){
      let total = 0;
      Object.values(cart).forEach(item => total += item.price * item.qty);
      return total;
    }

    function updateCartUI(){
      const keys = Object.keys(cart);
      if(keys.length === 0){
        cartCountEl.style.display = 'none';
        cartCountEl.textContent = '0';
      } else {
        cartCountEl.style.display = 'inline-block';
        const qty = keys.reduce((s,k)=> s + cart[k].qty,0);
        cartCountEl.textContent = qty;
      }
      const total = computeTotal();
      totalPriceEl.textContent = total.toFixed(2) + " MAD";
      modalTotal.textContent = total.toFixed(2) + " MAD";
      // Ø±Ù†Ø¯Ø± Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
      renderCartList();
    }

    function renderCartList(){
      cartList.innerHTML = '';
      const keys = Object.keys(cart);
      if(keys.length === 0){
        cartList.innerHTML = `<div style="padding:20px;color:var(--muted)">Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</div>`;
        return;
      }
      keys.forEach(k => {
        const it = cart[k];
        const div = document.createElement('div');
        div.className = 'cart-item';
        div.innerHTML = `
          <img src="${it.img}" alt="${it.title}" />
          <div style="flex:1;text-align:right">
            <div style="font-weight:700">${it.title}</div>
            <div style="color:var(--muted);font-size:13px">${it.price.toFixed(2)} ${it.currency} Ã— ${it.qty}</div>
          </div>
          <div style="display:flex;flex-direction:column;gap:6px;align-items:flex-start">
            <button class="cart-btn" onclick="changeQty('${k}',1)">+</button>
            <button class="cart-btn" onclick="changeQty('${k}',-1)">âˆ’</button>
            <button class="cart-btn" onclick="removeFromCart('${k}')">Ø­Ø°Ù</button>
          </div>
        `;
        cartList.appendChild(div);
      });
    }

    // ÙÙ„ØªØ±Ø© Ù…Ù† Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
    function filterBy(category){
      categorySelect.value = category === 'all' ? 'all' : category;
      renderProducts(searchInput.value, categorySelect.value);
    }

    // Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ÙÙ„ØªØ±
    searchInput.addEventListener('input', () => {
      renderProducts(searchInput.value, categorySelect.value);
    });
    categorySelect.addEventListener('change', () => {
      renderProducts(searchInput.value, categorySelect.value);
    });

    // ÙØªØ­/Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
    document.getElementById('openCartBtn').addEventListener('click', () => {
      modal.style.display = 'grid';
      modal.setAttribute('aria-hidden','false');
    });
    document.getElementById('closeModalBtn').addEventListener('click', closeModal);
    function closeModal(){
      modal.style.display = 'none';
      modal.setAttribute('aria-hidden','true');
    }
    // Ø§ØºÙ„Ø§Ù‚ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø®Ø§Ø±Ø¬ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
    modal.addEventListener('click', (e) => {
      if(e.target === modal) closeModal();
    });

    // Ø§Ù„Ø¯ÙØ¹ â€” ÙŠÙØªØ­ Ù†Ø§ÙØ°Ø© PayPal.me Ø£Ùˆ ÙŠØ¹Ù„Ù‘Ù‚ Ø¥Ù† Ù„Ù… ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø­Ø³Ø§Ø¨
    function checkout(){
      const total = computeTotal();
      if(total <= 0){
        alert("Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©ØŒ Ø£Ø¶Ù Ù…Ù†ØªØ¬Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ø¯ÙØ¹.");
        return;
      }
      if(!PAYPAL_USERNAME || PAYPAL_USERNAME === "USERNAME_HERE"){
        // ØªØ­Ø°ÙŠØ± ÙˆØ§Ø¶Ø­ ÙˆÙ„ÙŠØ³ Ø±ÙØ¶Ø§Ù‹
        const ok = confirm("Ù„Ù… ØªØ¶Ù Ø§Ø³Ù… Ø­Ø³Ø§Ø¨ PayPal.me ÙÙŠ Ø§Ù„ÙƒÙˆØ¯. Ø§Ø¶ØºØ· OK Ù„Ù†Ø³Ø® Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¯ÙØ¹ (ÙŠÙ…ÙƒÙ†Ùƒ ÙˆØ¶Ø¹ Ø§Ø³Ù… Ø­Ø³Ø§Ø¨Ùƒ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯). Ø§Ø¶ØºØ· Cancel Ù„Ø¥Ù„ØºØ§Ø¡.");
        if(!ok) return;
        // Ø§Ù†Ø³Ø® Ù†Øµ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ù„Ù†Ø³Ø® ÙŠØ¯ÙˆÙŠ
        copyToClipboard(`ÙØ§ØªÙˆØ±Ø© Ù…Ù† B7 STORE: Ø§Ù„Ù…Ø¨Ù„Øº ${total.toFixed(2)} MAD`);
        alert("ØªÙ… Ù†Ø³Ø® Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ø¨Ù„Øº Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©. Ø¨Ø¹Ø¯ Ø°Ù„Ùƒ Ø§ÙØªØ­ PayPal.me/Ø§Ø³Ù…Ùƒ ÙˆØ§Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº ÙŠØ¯ÙˆÙŠØ§Ù‹.");
        return;
      }

      // ØªÙƒÙˆÙŠÙ† Ø±Ø§Ø¨Ø· PayPal.me â€” Ù…Ù„Ø§Ø­Ø¸Ø©: Ø¨Ø¹Ø¶ Ø­Ø³Ø§Ø¨Ø§Øª PayPal.me ØªØ¯Ø¹Ù… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù„Øº Ø¹Ø¨Ø± /{amount}{currency}
      // Ù…Ø«Ø§Ù„: https://paypal.me/USERNAME/25MAD
      // Ù†Ø³ØªØ®Ø¯Ù… Ø°Ù„Ùƒ Ù„ÙƒÙ† Ù†Ø¹Ø±Ø¶ Ø£ÙŠØ¶Ø§Ù‹ ØªÙ†Ø¨ÙŠÙ‡ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ù„ØªØ£ÙƒØ¯.
      const amountStr = encodeURIComponent(total.toFixed(2) + "MAD");
      const url = `https://paypal.me/${encodeURIComponent(PAYPAL_USERNAME)}/${amountStr}`;

      // Ù†ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø· ÙÙŠ Ù†Ø§ÙØ°Ø© Ø¬Ø¯ÙŠØ¯Ø©
      window.open(url, '_blank');

      // Ø§Ù‚ØªØ±Ø§Ø­ ØªØ³Ø¬ÙŠÙ„ Ø·Ù„Ø¨ Ø£Ùˆ Ø¥Ø±Ø³Ø§Ù„ ØªÙØ§ØµÙŠÙ„ (ÙŠÙ…ÙƒÙ† Ø±Ø¨Ø· Ø¨Ø®Ø§Ø¯Ù… Ù„Ø§Ø­Ù‚Ø§Ù‹)
    }

    // Ø²Ø± Ø§Ù„Ø¯ÙØ¹ ÙÙŠ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ ÙˆØ§Ù„Ø²Ø± Ø§Ù„Ø¹Ø§Ø¦Ù…
    document.getElementById('checkoutBtn').addEventListener('click', () => {
      // Ø§ÙØªØ­ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ Ø£ÙˆÙ„Ø§Ù‹
      modal.style.display = 'grid';
      modal.setAttribute('aria-hidden','false');
    });
    document.getElementById('modalCheckoutBtn').addEventListener('click', checkout);

    // Ù…Ø³Ø§Ø¹Ø¯Ø© - Ù†Ø³Ø® Ù„Ù„Ø­Ø§ÙØ¸Ø©
    function copyToClipboard(text){
      if(navigator.clipboard && navigator.clipboard.writeText){
        navigator.clipboard.writeText(text).catch(()=>{});
      } else {
        const ta = document.createElement('textarea');
        ta.value = text; document.body.appendChild(ta); ta.select();
        try{ document.execCommand('copy'); }catch(e){}
        ta.remove();
      }
    }

    // Ø±Ù†Ø¯Ø± Ø£ÙˆÙ„ÙŠ
    renderProducts();

    // Ø§Ø®ØªÙŠØ§Ø±ÙŠ: ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø³Ù„Ø© ÙÙŠ localStorage Ø­ØªÙ‰ Ù„Ø§ ØªØ¶ÙŠØ¹
    function saveCart(){
      localStorage.setItem('b7_cart', JSON.stringify(cart));
    }
    function loadCart(){
      try{
        const s = localStorage.getItem('b7_cart');
        if(s) cart = JSON.parse(s);
      }catch(e){ cart = {}; }
      updateCartUI();
    }
    window.addEventListener('beforeunload', saveCart);
    loadCart();

    // ÙØ­Øµ Ø£Ø®Ø·Ø§Ø¡ Ø¨Ø³ÙŠØ·Ø© (Ù„Ø¶Ù…Ø§Ù† Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø£Ø®Ø·Ø§Ø¡ Ø´Ø§Ø¦Ø¹Ø©)
    window.addEventListener('error', (e) => {
      console.error('Runtime error:', e.error || e.message);
      // Ù„Ø§ Ù†ÙØ¸Ù‡Ø± Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø´ÙŠØ¦Ø§Ù‹ Ù…Ø²Ø¹Ø¬Ø§Ù‹ Ù„ÙƒÙ† ÙŠÙ…ÙƒÙ† Ø¥Ø±Ø³Ø§Ù„ Ù‡Ø°Ø§ Ù„Ù„Ø®Ø§Ø¯Ù… Ù„Ø§Ø­Ù‚Ø§Ù‹
    });
  </script>
</body>
  </html>
